<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Cinematic Milky Way Galaxy</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
html,body{margin:0;height:100%;background:#000;overflow:hidden}
#ui{
  position:fixed;left:16px;top:16px;z-index:20;
  background:rgba(0,0,0,.45);
  color:#fff;padding:12px 14px;
  border-radius:10px;font-family:system-ui;font-size:13px;
}
canvas{display:block}
</style>
</head>
<body>

<div id="ui">
<b>Milky Way (Cinematic)</b><br>
‚ú® Spiral arms<br>
üå´Ô∏è Nebula fog<br>
üåÄ Dust lanes<br>
üåü Bloom glow<br>
ü™ê Solar system inside
</div>

<script type="importmap">
{
  "imports": {
    "three": "https://cdn.jsdelivr.net/npm/three@0.164.1/build/three.module.js",
    "post": "https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/postprocessing/"
  }
}
</script>

<script type="module">
import * as THREE from "three";
import { OrbitControls } from
"https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/controls/OrbitControls.js";
import { EffectComposer } from
"https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/postprocessing/EffectComposer.js";
import { RenderPass } from
"https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/postprocessing/RenderPass.js";
import { UnrealBloomPass } from
"https://cdn.jsdelivr.net/npm/three@0.164.1/examples/jsm/postprocessing/UnrealBloomPass.js";

/* ================= BASIC ================= */
const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio,2));
renderer.toneMapping=THREE.ACESFilmicToneMapping;
renderer.toneMappingExposure=1.05;
document.body.appendChild(renderer.domElement);

const scene=new THREE.Scene();
scene.background=new THREE.Color(0x020209);
scene.fog=new THREE.FogExp2(0x070711,0.00045);

const camera=new THREE.PerspectiveCamera(50,innerWidth/innerHeight,0.1,12000);
camera.position.set(0,800,2400);

const controls=new OrbitControls(camera,renderer.domElement);
controls.enableDamping=true;
controls.enablePan=false;

/* ================= POST ================= */
const composer=new EffectComposer(renderer);
composer.addPass(new RenderPass(scene,camera));
composer.addPass(new UnrealBloomPass(
  new THREE.Vector2(innerWidth,innerHeight),
  0.85, 0.55, 0.7
));

/* ================= ROOT ================= */
const galaxyRoot=new THREE.Group();
scene.add(galaxyRoot);

/* ================= TEXTURES ================= */
const tl=new THREE.TextureLoader();
const starTex=tl.load("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/sprites/disc.png");
const smokeTex=tl.load("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/sprites/smoke.png");

/* ================= SPIRAL GALAXY ================= */
function createSpiralGalaxy(){
  const arms=4, count=22000;
  const pos=[], col=[];
  for(let i=0;i<count;i++){
    const arm=i%arms;
    const angle=i*0.03 + arm*(Math.PI*2/arms);
    const radius=Math.pow(Math.random(),0.55)*2600;
    const spiral=angle + radius*0.002;

    const x=Math.cos(spiral)*radius + (Math.random()-0.5)*40;
    const z=Math.sin(spiral)*radius + (Math.random()-0.5)*40;
    const y=(Math.random()-0.5)*120*Math.exp(-radius/1400);

    pos.push(x,y,z);

    const c=new THREE.Color();
    c.setHSL(0.6 + radius/5000,0.6,0.65);
    col.push(c.r,c.g,c.b);
  }

  const g=new THREE.BufferGeometry();
  g.setAttribute("position",new THREE.Float32BufferAttribute(pos,3));
  g.setAttribute("color",new THREE.Float32BufferAttribute(col,3));

  galaxyRoot.add(new THREE.Points(
    g,
    new THREE.PointsMaterial({
      size:1.1,
      vertexColors:true,
      transparent:true,
      blending:THREE.AdditiveBlending,
      depthWrite:false
    })
  ));
}
createSpiralGalaxy();

/* ================= DUST LANES ================= */
function dustLanes(){
  for(let i=0;i<160;i++){
    const s=new THREE.Sprite(
      new THREE.SpriteMaterial({
        map:smokeTex,
        color:0x221a14,
        opacity:0.12,
        transparent:true,
        depthWrite:false
      })
    );
    const r=800+Math.random()*1600;
    const a=Math.random()*Math.PI*2;
    s.position.set(Math.cos(a)*r,(Math.random()-0.5)*140,Math.sin(a)*r);
    s.scale.set(500,500,1);
    galaxyRoot.add(s);
  }
}
dustLanes();

/* ================= NEBULA CLOUDS ================= */
function nebula(){
  for(let i=0;i<180;i++){
    const s=new THREE.Sprite(
      new THREE.SpriteMaterial({
        map:smokeTex,
        color:new THREE.Color().setHSL(0.65+Math.random()*0.15,0.7,0.5),
        opacity:0.08,
        transparent:true,
        depthWrite:false
      })
    );
    const r=500+Math.random()*2400;
    const a=Math.random()*Math.PI*2;
    s.position.set(Math.cos(a)*r,(Math.random()-0.5)*260,Math.sin(a)*r);
    s.scale.set(700+Math.random()*800,700+Math.random()*800,1);
    galaxyRoot.add(s);
  }
}
nebula();

/* ================= SOLAR SYSTEM ================= */
const solar=new THREE.Group();
solar.position.set(1200,0,400);
galaxyRoot.add(solar);

const sunTex=tl.load("https://diwakarasd.github.io/galaxy-textures/2k_sun.jpg");
const sun=new THREE.Mesh(
  new THREE.SphereGeometry(14,48,32),
  new THREE.MeshBasicMaterial({map:sunTex})
);
solar.add(sun);

/* Controlled Sun Glow */
const sunGlow=new THREE.Sprite(
  new THREE.SpriteMaterial({
    map:starTex,
    color:0xffcc88,
    opacity:0.28,
    blending:THREE.AdditiveBlending
  })
);
sunGlow.scale.set(80,80,1);
sun.add(sunGlow);

/* Planets */
function planet(size,dist,speed,tex,ring=false){
  const h=new THREE.Object3D();
  solar.add(h);
  const m=new THREE.Mesh(
    new THREE.SphereGeometry(size,32,32),
    new THREE.MeshBasicMaterial({map:tex})
  );
  h.add(m);

  if(ring){
    const r=new THREE.Mesh(
      new THREE.RingGeometry(size*1.4,size*2.6,64),
      new THREE.MeshBasicMaterial({
        map:tl.load("https://diwakarasd.github.io/galaxy-textures/2k_saturn_ring_alpha.png"),
        transparent:true,
        side:THREE.DoubleSide,
        depthWrite:false
      })
    );
    r.rotation.x=Math.PI/2-0.35;
    m.add(r);
  }
  return {h,m,dist,speed,a:Math.random()*Math.PI*2};
}

const planets=[
  planet(2,28,0.015,tl.load("https://diwakarasd.github.io/galaxy-textures/2k_mercury.jpg")),
  planet(3.5,38,0.012,tl.load("https://diwakarasd.github.io/galaxy-textures/2k_venus_surface.jpg")),
  planet(3.8,50,0.01,tl.load("https://diwakarasd.github.io/galaxy-textures/2k_earth_daymap.jpg")),
  planet(2.4,62,0.008,tl.load("https://diwakarasd.github.io/galaxy-textures/2k_mars.jpg")),
  planet(7,84,0.004,tl.load("https://diwakarasd.github.io/galaxy-textures/2k_jupiter.jpg")),
  planet(6.2,110,0.003,tl.load("https://diwakarasd.github.io/galaxy-textures/2k_saturn.jpg"),true)
];

/* ================= CINEMATIC CAMERA INTRO ================= */
let t=0;
function animate(){
  requestAnimationFrame(animate);
  t+=0.001;

  planets.forEach(p=>{
    p.a+=p.speed;
    p.m.position.set(Math.cos(p.a)*p.dist,0,Math.sin(p.a)*p.dist);
  });

  if(t<1){
    camera.position.lerp(new THREE.Vector3(0,300,1400),0.01);
    camera.lookAt(0,0,0);
  }

  galaxyRoot.rotation.y+=0.00012;
  controls.update();
  composer.render();
}
animate();

addEventListener("resize",()=>{
  camera.aspect=innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth,innerHeight);
  composer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
